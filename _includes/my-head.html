{% comment %}
<!--
Using `preload` so that page rendering doesn't get blocked.
Fill in `href`. You may have to adjust `as` and `onload`/`rel`, depending on content.
-->
<link href="<path/to/content.css>" rel="preload" as="style" onload="this.rel='stylesheet'">

<!--
Fallback in case JavaScript isn't enabled.
Fill in `href`. You may have to adjust `rel`.
-->
<noscript><link href="<path/to/content.css>" rel="stylesheet"></noscript>
{% endcomment %}

<style>
/* Scoped, conservative tweaks to avoid layout breakage */

/* Sidebar background: use cover for better fill without distorting layout */
.sidebar,
.sidebar-bg,
hy-drawer .sidebar,
hy-drawer .sidebar-bg {
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Sidebar text readability: subtle overlay */
.sidebar .sidebar-sticky {
  background: rgba(0,0,0,0.45);
  border-radius: 8px;
  padding: 1rem;
  backdrop-filter: blur(2px);
}

/* Keep link contrast inside sidebar without forcing global styles */
.sidebar a { color: #fff; text-decoration: none; }
.sidebar a:hover { opacity: 0.9; }

/* Optional: improve headings contrast in sidebar only */
.sidebar h1,
.sidebar h2,
.sidebar h3,
.sidebar h4,
.sidebar h5,
.sidebar h6 { color: #fff; }
</style>

{% comment %} Fallback dark mode initialization for GitHub Pages compatibility {% endcomment %}
{% if site.hydejack.dark_mode.icon %}
<script>
// Ensure dark mode button appears and works on GitHub Pages
window.addEventListener('DOMContentLoaded', function() {
  // Check if dark mode button template exists
  var template = document.getElementById('_dark-mode-template');
  if (template && !document.getElementById('_dark-mode')) {
    // Clone and insert the dark mode button
    var darkModeBtn = template.content.cloneNode(true);
    var navbar = document.querySelector('#_navbar > .content > .nav-btn-bar');
    if (navbar) {
      navbar.appendChild(darkModeBtn);
      
      // Add click handler for dark mode toggle
      var btn = document.getElementById('_dark-mode');
      if (btn) {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          var classList = document.body.classList;
          if (classList.contains('dark-mode') || 
              (!classList.contains('light-mode') && 
               window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            classList.remove('dark-mode');
            classList.add('light-mode');
          } else {
            classList.remove('light-mode');
            classList.add('dark-mode');
          }
        });
      }
      
      // Remove no-color-transition class to enable smooth transitions
      document.body.classList.remove('no-color-transition');
    }
  }
});
</script>
{% endif %}
