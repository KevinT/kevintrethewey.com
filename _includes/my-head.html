{% comment %}
<!--
Using `preload` so that page rendering doesn't get blocked.
Fill in `href`. You may have to adjust `as` and `onload`/`rel`, depending on content.
-->
<link href="<path/to/content.css>" rel="preload" as="style" onload="this.rel='stylesheet'">

<!--
Fallback in case JavaScript isn't enabled.
Fill in `href`. You may have to adjust `rel`.
-->
<noscript><link href="<path/to/content.css>" rel="stylesheet"></noscript>
{% endcomment %}

<style>
/* DIRECT CSS - BACKGROUND IMAGE FIX - AGGRESSIVE TARGETING */
.sidebar,
.sidebar-bg,
hy-drawer .sidebar,
hy-drawer .sidebar-bg,
body .sidebar,
body .sidebar-bg,
html body .sidebar,
html body .sidebar-bg,
.sidebar .sidebar-bg,
hy-drawer.loaded .sidebar,
hy-drawer.loaded .sidebar-bg {
  background-size: contain !important;
  background-repeat: no-repeat !important;
  background-position: center center !important;
}

/* Target any element with background image */
[style*="background-image"] {
  background-size: contain !important;
  background-repeat: no-repeat !important;
  background-position: center center !important;
}

/* Even more specific targeting */
* {
  background-size: contain !important;
  background-repeat: no-repeat !important;
  background-position: center center !important;
}

/* Override any inline styles */
.sidebar[style],
.sidebar-bg[style],
hy-drawer .sidebar[style],
hy-drawer .sidebar-bg[style] {
  background-size: contain !important;
  background-repeat: no-repeat !important;
  background-position: center center !important;
}

/* SIDEBAR TEXT READABILITY FIXES */
.sidebar .sidebar-sticky {
  background: rgba(0,0,0,0.7) !important;
  border-radius: 8px !important;
  padding: 1.5rem !important;
  backdrop-filter: blur(4px) !important;
  position: relative !important;
  z-index: 999 !important;
  box-shadow: 0 4px 12px rgba(0,0,0,0.5) !important;
}

.sidebar a {
  color: #ffffff !important;
  text-shadow: 0 2px 4px rgba(0,0,0,1) !important;
  font-weight: 700 !important;
  text-decoration: none !important;
}

.sidebar a:hover {
  color: #ffffff !important;
  text-shadow: 0 2px 6px rgba(0,0,0,1) !important;
  opacity: 0.9 !important;
}

.sidebar .text-muted,
.sidebar p,
.sidebar span,
.sidebar div {
  color: #ffffff !important;
  text-shadow: 0 2px 4px rgba(0,0,0,1) !important;
  font-weight: 600 !important;
}

.sidebar h1,
.sidebar h2,
.sidebar h3,
.sidebar h4,
.sidebar h5,
.sidebar h6 {
  color: #ffffff !important;
  text-shadow: 0 2px 4px rgba(0,0,0,1) !important;
  font-weight: 700 !important;
}

/* NAVIGATION BUTTONS - SIMPLE VISIBILITY FIX */
#_menu,
#_search,
#_dark-mode {
  color: #000000 !important;
  background: rgba(255,255,255,0.7) !important;
  border-radius: 3px !important;
  padding: 4px !important;
}

.icon-menu::before,
.icon-contrast::before {
  color: #000000 !important;
  text-shadow: 0 0 2px rgba(255,255,255,1) !important;
}

.nav-btn:hover,
a.nav-btn:hover,
#_menu:hover,
#_search:hover,
#_dark-mode:hover {
  color: #ffffff !important;
  opacity: 0.8 !important;
  background: rgba(0,0,0,0.5) !important;
}

.nav-btn:hover .icon-contrast,
.nav-btn:hover .icon-menu,
a.nav-btn:hover .icon-contrast,
a.nav-btn:hover .icon-menu,
#_menu:hover .icon-contrast,
#_menu:hover .icon-menu,
#_search:hover .icon-contrast,
#_search:hover .icon-menu,
#_dark-mode:hover .icon-contrast,
#_dark-mode:hover .icon-menu {
  color: #ffffff !important;
  opacity: 0.8 !important;
}

</style>

{% comment %} Fallback dark mode initialization for GitHub Pages compatibility {% endcomment %}
{% if site.hydejack.dark_mode.icon %}
<script>
// Ensure dark mode button appears and works on GitHub Pages
window.addEventListener('DOMContentLoaded', function() {
  // Check if dark mode button template exists
  var template = document.getElementById('_dark-mode-template');
  if (template && !document.getElementById('_dark-mode')) {
    // Clone and insert the dark mode button
    var darkModeBtn = template.content.cloneNode(true);
    var navbar = document.querySelector('#_navbar > .content > .nav-btn-bar');
    if (navbar) {
      navbar.appendChild(darkModeBtn);
      
      // Add click handler for dark mode toggle
      var btn = document.getElementById('_dark-mode');
      if (btn) {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          var classList = document.body.classList;
          if (classList.contains('dark-mode') || 
              (!classList.contains('light-mode') && 
               window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            classList.remove('dark-mode');
            classList.add('light-mode');
          } else {
            classList.remove('light-mode');
            classList.add('dark-mode');
          }
        });
      }
      
      // Remove no-color-transition class to enable smooth transitions
      document.body.classList.remove('no-color-transition');
    }
  }
});
</script>
{% endif %}
